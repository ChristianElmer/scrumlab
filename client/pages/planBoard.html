<template name="planBoard">


    {{#with project}}
    <div class="page-header">
        <h1>{{gitlab.name}} - Plan your work</h1>
    </div>

    {{/with}}


    <!--glyphicon glyphicon-plus-->

    <!--<style>
        .double-input .form-control {
            width: 40%;
            border-right-width: 0px;
        }
        .double-input .form-control:focus {
            border-right-width: 1px;
        }
    </style>-->


    <div class="row">
        <div class="col-md-8 col-md-offset-2">
            <form class="form-horizontal">

                <div class="form-group">

                    <div class="input-group input-group-lg double-input">
                        <input type="text" class="form-control" placeholder="Story title">
                        <div class="input-group-btn">
                            <button class="btn btn-success" type="button">Add</button>
                        </div>
                    </div>

                </div>
                <div class="form-group">
                    Details
                </div>

                <div class="form-group">
                    <textarea rows="4" class="form-control" id="storyDesc" placeholder="Story description"></textarea>
                </div>

                <div class="form-group">

                    <div class="row">
                        <div class="col-xs-8">
                            <input type="text" class="form-control" placeholder="Team estimations: 4; 2; 3...">
                        </div>

                        <div class="col-xs-2">
                            <label for="inputEst" class="control-label">Estimation:</label>

                        </div>
                        <div class="col-xs-2">
                            <input type="number" class="form-control" id="inputEst">
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
    {{> planBoardSprints}}
</template>

<template name="planBoardInput">
    <details class="addStory">
        <summary>Add new issue</summary>
        <input type="text" id="name" style="width: 95%" placeholder="Name" />
        <br/>
        <input type="text" id="description" style="width: 95%" placeholder="Description" />
        <br/>Estimated time:
        <input type="number" id="estimate" style="width: 5%" />
        <br/>Issue type:
        <select id="typeSelector" style="width: 20%">
            <option value="opened">opened</option>
            <option value="inProgress">in progress</option>
            <option value="closed">closed</option>
            <option value="other">other</option>
        </select>
        <br/>Assigned to:
        <select id="assigneeSelector" style="width: 20%">{{> planBoardAssignees}}</select>
        <input type="button" class="insert" value="Dodaj" style="float: right" />
    </details>
</template>

<template name="planBoardAssignees">
    {{#each assignees}}
    <option value={{_id}}>{{username}}</option>
    {{/each}}
</template>

<template name="planBoardSprints">
    <input type="hidden" id="projectId" ref={{project._id}}>
    <div id="sprints" class=".col-md-6">{{> planBoardSprintsList}}</div>
    <div id="backlog" class=".col-md-6" ref="0">
        {{#each issues}}
        <div class="story" id={{_id}} ref={{sprint}} objectType="issue">
            <p class="storyTitle" ref="title" data-type="text">{{gitlab.title}}</p>
            <p class="storyType" ref="state" data-type="text">{{gitlab.state}}</p>
            <p class="storyText" ref="description" data-type="textarea">{{gitlab.description}}</p>
            <p class="storyHours" ref="estimate" data-type="text" data-placeholder="estimate">{{estimate}}</p>
            <p class="storyAssignee" ref="gitlab.assignee.username" data-type="text">Assigned to: {{gitlab.assignee.username}}</p>
            <p class="deleteButton"></p>
            <div>
                <details>
                    <summary>Tasks</summary>
                    {{#each tasks _id}}
                    <div class="task" id={{_id}} ref={{name}} objectType="task">
                        <p class="taskTitle" ref="name" data-type="text">{{name}}</p>
                        <p class="taskHours" ref="estimate" data-type="text">{{estimate}}</p>
                        <p class="taskText" ref="description" data-type="textarea">{{description}}</p>
                        <p class="taskAssignee" ref="assignee" data-type="text">Assigned to: {{assignee}}</p>
                        <p class="deleteButton"></p>
                    </div>
                    {{/each}}
                    <details class="addTask">
                        <summary>Add task</summary>
                        <input type="text" class="tName" style="width: 95%" placeholder="Name" />
                        <br/>
                        <input type="text" class="tDescription" style="width: 95%" placeholder="Description" />
                        <br/>Estimated time:
                        <input type="number" class="tTime" style="width: 10%" />
                        <br/>Assigned to:
                        <select class="tAssigneeSelector" style="width: 30%">{{> planBoardAssignees}}</select>
                        <input type="button" class="insertTask" value="Dodaj" style="float: right" />
                    </details>
                </details>
            </div>
        </div>
        {{/each}}
        <p id="backlogFooter">{{issuesStats}}</p>
    </div>
</template>

<template name="planBoardSprintsList">
    {{#each sprints}}
    <div class="sprint" id={{_id}} ref={{time}}>
        <div class="sprintInfo"><b>{{name}}</b> End date: {{endDate}} Status: {{status}}
            <div class="sprintTimeMarker">{{time}}</div>
        </div>
        <button type="button" class="startButton" id={{_id}}>Start
        </button>
        {{#each assignedItems _id}}
        <div class="story" id={{_id}} ref={{gitlab.title}} objectType="issue">
            <p class="storyTitle" ref="title" data-type="text">{{gitlab.title}}</p>
            <p class="storyType" ref="state" data-type="text">{{gitlab.state}}</p>
            <p class="storyText" ref="description" data-type="textarea">{{gitlab.description}}</p>
            <p class="storyHours" ref="estimate" data-type="text" data-placeholder="estimate">{{estimate}}</p>
            <p class="storyAssignee" ref="gitlab.assignee.username" data-type="text">Assigned to: {{gitlab.assignee.username}}</p>
        </div>
        {{/each}}
    </div>
    {{/each}} {{> planBoardSprintsInput}}
</template>

<template name="planBoardSprintsInput">
    <details id="addSprint">
        <summary>New sprint</summary>
        <input type="text" id="name" style="width: 98%; margin: 1%;" placeholder="Sprint title" />
        <input type="text" id="datepicker" style="width: 66%; margin: 1%;" placeholder="End date" />
        <input type="button" class="insert" style="width: 29%; margin: 1%;" value="Add" />
    </details>
</template>